<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="resources/ol.css">
    <link rel="stylesheet" href="resources/fontawesome-all.min.css">
    <link rel="stylesheet" type="text/css" href="resources/horsey.min.css">
    <link rel="stylesheet" type="text/css" href="resources/ol3-search-layer.min.css">
    <link rel="stylesheet" href="resources/ol-layerswitcher.css">
    <link rel="stylesheet" href="resources/qgis2web.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <title>The Chocó Alliance Web Map</title>
</head>
<body>
    <div id="frame">
        <div class="header">
            <a href="https://www.chocoalliance.org/" class="logo" target="_blank">
                <img src="Logo-Stacked.png" alt="Logo" height="60" />
            </a>
            <div class="title">The Chocó Alliance Web Map</div>
        </div>
        <div id="left-widgets">
            <div class="widget" id="measure-widget" title="Measure">
                <i class="fas fa-ruler"></i>
            </div>
            <div class="widget" id="draw-widget" title="Draw">
                <i class="fas fa-pencil-alt"></i>
            </div>
            <div class="widget" id="swipe-widget" title="Layer Swipe">
                <i class="fas fa-exchange-alt"></i>
            </div>
            <div class="widget" id="export-widget" title="Export Map">
                <i class="fas fa-download"></i>
            </div>
            <div class="widget" id="upload-widget" title="Upload Data">
                <i class="fas fa-upload"></i>
            </div>
        </div>
        <div class="map-container">
            <div id="map">
                <div id="popup" class="ol-popup">
                    <a href="#" id="popup-closer" class="ol-popup-closer"></a>
                    <div id="popup-content"></div>
                </div>
                
                <!-- Measure Tool Controls -->
                <div class="measure-control ol-unselectable ol-control">
                    <select id="measure-type" style="display: none;">
                        <option value="length">Length</option>
                        <option value="area">Area</option>
                    </select>
                </div>
                
                <!-- Draw Tool Controls -->
                <div class="draw-control ol-unselectable ol-control">
                    <select id="draw-type" style="display: none;">
                        <option value="Point">Point</option>
                        <option value="LineString">Line</option>
                        <option value="Polygon">Polygon</option>
                        <option value="Circle">Circle</option>
                    </select>
                </div>
                
                <!-- Layer Swipe Control -->
                <div class="swipe-control" style="display: none;">
                    <input id="swipe" type="range" style="width: 100%">
                </div>
                
                <!-- Export Control -->
                <div class="export-control" style="display: none;">
                    <a id="image-download" download="map.png"></a>
                </div>
            </div>
        </div>
        <div class="bottom-widgets">
            <div class="created-by">
                <a href="https://nl.linkedin.com/in/abdulaziz-yusuf-ali" target="_blank">Created by AzyAli</a>
            </div>
        </div>
    </div>
    
    <!-- Base Scripts -->
    <script src="resources/qgis2web_expressions.js"></script>
    <script src="resources/proj4.js"></script>
    <script>proj4.defs('EPSG:4326','+proj=longlat +datum=WGS84 +no_defs');</script>
    <script src="resources/polyfills.js"></script>
    <script src="resources/functions.js"></script>
    <script src="resources/ol.js"></script>
    <script src="https://cdn.polyfill.io/v2/polyfill.min.js?features=Element.prototype.classList,URL"></script>
    <script src="resources/horsey.min.js"></script>
    <script src="resources/ol3-search-layer.js"></script>
    <script src="resources/ol-layerswitcher.js"></script>
    
    <!-- Load all layer files -->
    <script src="layers/Terrestrial_ecoregions_6.js"></script>
    <script src="layers/Ecuador_7.js"></script>
    <script src="layers/Potentialwildlifecorridors_8.js"></script>
    <script src="layers/Rivers_9.js"></script>
    <script src="layers/MiningCONCESIONES1_10.js"></script>
    <script src="layers/MiningCONCESIONESN_11.js"></script>
    <script src="layers/MiningCONCESIONESS_12.js"></script>
    <script src="layers/Communities_13.js"></script>
    <script src="layers/indigenousreserves_14.js"></script>
    <script src="layers/Acusmit_15.js"></script>
    <script src="layers/BOSQUESPROTECTORES_16.js"></script>
    <script src="layers/CotocachiCayapasEcologicalReserve_17.js"></script>
    <script src="layers/MacheChindul_18.js"></script>
    <script src="layers/Reserva_Biosfera_Choco_19.js"></script>
    <script src="layers/ChachiReserves_20.js"></script>
    <script src="layers/JocotocoCanande_21.js"></script>
    <script src="layers/Maquipucuna_22.js"></script>
    <script src="layers/LosCedrosReserve_23.js"></script>
    <script src="layers/MaquipucunaReserve_24.js"></script>
    <script src="layers/NeblinaReserve_25.js"></script>
    <script src="layers/Ecominga_26.js"></script>
    <script src="layers/TesoroEscondidoReserve_27.js"></script>
    <script src="layers/TMAPATADEPATAJO_28.js"></script>
    <script src="layers/TMAJAMACOAQUE_29.js"></script>
    <script src="layers/FCATBilsa_30.js"></script>
    <script src="layers/FCATReserve_31.js"></script>
    <script src="layers/LA_ESPERANZA_32.js"></script>
    <script src="layers/DRACULA_ZONA_ALTA_33.js"></script>
    <script src="layers/DRACULA_ZONA_BAJA_34.js"></script>
    <script src="layers/DRACULA_ZONA_MEDIA_35.js"></script>
    <script src="layers/Cuellaje_reservas_36.js"></script>
    <script src="layers/Apuela_reservas_37.js"></script>
    <script src="layers/Penaherrera_reservas_38.js"></script>
    <script src="layers/GarciaMoreno_reservas_39.js"></script>
    <script src="layers/VacasGalindo_reservas_40.js"></script>
    
    <!-- Load all style files -->
    <script src="styles/Terrestrial_ecoregions_6_style.js"></script>
    <script src="styles/Ecuador_7_style.js"></script>
    <script src="styles/Potentialwildlifecorridors_8_style.js"></script>
    <script src="styles/Rivers_9_style.js"></script>
    <script src="styles/MiningCONCESIONES1_10_style.js"></script>
    <script src="styles/MiningCONCESIONESN_11_style.js"></script>
    <script src="styles/MiningCONCESIONESS_12_style.js"></script>
    <script src="styles/Communities_13_style.js"></script>
    <script src="styles/indigenousreserves_14_style.js"></script>
    <script src="styles/Acusmit_15_style.js"></script>
    <script src="styles/BOSQUESPROTECTORES_16_style.js"></script>
    <script src="styles/CotocachiCayapasEcologicalReserve_17_style.js"></script>
    <script src="styles/MacheChindul_18_style.js"></script>
    <script src="styles/Reserva_Biosfera_Choco_19_style.js"></script>
    <script src="styles/ChachiReserves_20_style.js"></script>
    <script src="styles/JocotocoCanande_21_style.js"></script>
    <script src="styles/Maquipucuna_22_style.js"></script>
    <script src="styles/LosCedrosReserve_23_style.js"></script>
    <script src="styles/MaquipucunaReserve_24_style.js"></script>
    <script src="styles/NeblinaReserve_25_style.js"></script>
    <script src="styles/Ecominga_26_style.js"></script>
    <script src="styles/TesoroEscondidoReserve_27_style.js"></script>
    <script src="styles/TMAPATADEPATAJO_28_style.js"></script>
    <script src="styles/TMAJAMACOAQUE_29_style.js"></script>
    <script src="styles/FCATBilsa_30_style.js"></script>
    <script src="styles/FCATReserve_31_style.js"></script>
    <script src="styles/LA_ESPERANZA_32_style.js"></script>
    <script src="styles/DRACULA_ZONA_ALTA_33_style.js"></script>
    <script src="styles/DRACULA_ZONA_BAJA_34_style.js"></script>
    <script src="styles/DRACULA_ZONA_MEDIA_35_style.js"></script>
    <script src="styles/Cuellaje_reservas_36_style.js"></script>
    <script src="styles/Apuela_reservas_37_style.js"></script>
    <script src="styles/Penaherrera_reservas_38_style.js"></script>
    <script src="styles/GarciaMoreno_reservas_39_style.js"></script>
    <script src="styles/VacasGalindo_reservas_40_style.js"></script>
    
    <!-- Load layers configuration -->
    <script src="layers/layers.js"></script>
    <script src="resources/Autolinker.min.js"></script>
    <script src="resources/qgis2web.js"></script>
    
    <!-- Custom Scripts -->
    <script src="js/measure.js"></script>
    <script src="js/draw.js"></script>
    <script src="js/layerSwipe.js"></script>
    <script src="js/export.js"></script>
    <script src="js/upload.js"></script>
    <script src="js/main.js"></script>
    
    <script>
        var wms_layers = [];
        
        // Initialize basemap layers
        var baseLayer = new ol.layer.Tile({
            'title': 'OpenStreetMap',
            'type': 'base',
            source: new ol.source.XYZ({
                url: 'https://tile.openstreetmap.org/{z}/{x}/{y}.png'
            })
        });

        var lyr_GoogleSatellite = new ol.layer.Tile({
            'title': 'Google Satellite',
            'type': 'base',
            source: new ol.source.XYZ({
                url: 'https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}'
            })
        });

        var lyr_GoogleTerrain = new ol.layer.Tile({
            'title': 'Google Terrain',
            'type': 'base',
            source: new ol.source.XYZ({
                url: 'https://mt1.google.com/vt/lyrs=p&x={x}&y={y}&z={z}'
            })
        });

        // Initialize the map
        var map = new ol.Map({
            target: 'map',
            layers: [
                baseLayer,
                lyr_GoogleSatellite,
                lyr_GoogleTerrain,
                lyr_Terrestrial_ecoregions_6,
                lyr_Ecuador_7,
                lyr_Potentialwildlifecorridors_8,
                lyr_Rivers_9,
                lyr_MiningCONCESIONES1_10,
                lyr_MiningCONCESIONESN_11,
                lyr_MiningCONCESIONESS_12,
                lyr_Communities_13,
                lyr_indigenousreserves_14,
                lyr_Acusmit_15,
                lyr_BOSQUESPROTECTORES_16,
                lyr_CotocachiCayapasEcologicalReserve_17,
                lyr_MacheChindul_18,
                lyr_Reserva_Biosfera_Choco_19,
                lyr_ChachiReserves_20,
                lyr_JocotocoCanande_21,
                lyr_Maquipucuna_22,
                lyr_LosCedrosReserve_23,
                lyr_MaquipucunaReserve_24,
                lyr_NeblinaReserve_25,
                lyr_Ecominga_26,
                lyr_TesoroEscondidoReserve_27,
                lyr_TMAPATADEPATAJO_28,
                lyr_TMAJAMACOAQUE_29,
                lyr_FCATBilsa_30,
                lyr_FCATReserve_31,
                lyr_LA_ESPERANZA_32,
                lyr_DRACULA_ZONA_ALTA_33,
                lyr_DRACULA_ZONA_BAJA_34,
                lyr_DRACULA_ZONA_MEDIA_35,
                lyr_Cuellaje_reservas_36,
                lyr_Apuela_reservas_37,
                lyr_Penaherrera_reservas_38,
                lyr_GarciaMoreno_reservas_39,
                lyr_VacasGalindo_reservas_40
            ],
            view: new ol.View({
                center: ol.proj.fromLonLat([-79.0, 0.5]),  // Center on Ecuador
                zoom: 8
            })
        });

        // Initialize layer switcher
        var layerSwitcher = new ol.control.LayerSwitcher({
            tipLabel: 'Layers',
            groupSelectStyle: 'group'
        });
        map.addControl(layerSwitcher);

        // Initialize zoom control
        var zoomControl = new ol.control.Zoom({
            target: 'zoom-widget'
        });
        map.addControl(zoomControl);

        // Initialize full screen control
        var fullScreenControl = new ol.control.FullScreen({
            target: 'fullscreen-widget'
        });
        map.addControl(fullScreenControl);

        // Initialize popup
        var container = document.getElementById('popup');
        var content = document.getElementById('popup-content');
        var closer = document.getElementById('popup-closer');
        var overlay = new ol.Overlay({
            element: container,
            autoPan: true,
            autoPanAnimation: {
                duration: 250
            }
        });
        map.addOverlay(overlay);

        closer.onclick = function() {
            overlay.setPosition(undefined);
            closer.blur();
            return false;
        };

        map.on('singleclick', function(evt) {
            var coordinate = evt.coordinate;
            var hdms = ol.coordinate.toStringHDMS(ol.proj.transform(
                coordinate, 'EPSG:3857', 'EPSG:4326'));

            content.innerHTML = '<p>You clicked here:</p><code>' + hdms + '</code>';
            overlay.setPosition(coordinate);
        });
    </script>
</body>
</html>